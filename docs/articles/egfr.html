<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Estimated GFR • transplantr</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Estimated GFR">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">transplantr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.0.900</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/egfr.html">Estimated GFR</a>
    </li>
    <li>
      <a href="../articles/kidney_risk_scores.html">Kidney Donor and Recipient Risk Index</a>
    </li>
    <li>
      <a href="../articles/liver_recipient_scoring.html">Liver recipient scoring</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Estimated GFR</h1>
            
      
      
      <div class="hidden name"><code>egfr.Rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(transplantr)</a></code></pre></div>
<div id="introduction" class="section level1">
<h1 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h1>
<p>Glomerular filtration rate can only be determined accurately by direct measurement of renal clearance of markers such as inulin, <sup>51</sup>Cr-EDTA, <sup>125</sup>I-iothalamate or iohexol, but GFR can be estimated from serum creatinine using a number of established formulae. There is no perfect formula for all levels of renal function, and all formulae can be inaccurate if renal function is unstable, at extremes of BMI, in pregnancy, muscle wasting or gross oedema.</p>
<p>The <strong>CKD-EPI</strong> and abbreviated <strong>MDRD</strong> formulae are the ones most commonly used for adults, and are both based on large numbers of patients with direct GFR measurement and standardised serum creatinine measurements using isotope dilution mass spectrometry. The CKD-EPI formula is more accurate for patients with GFR greater than 60 ml/min, although as both formulae are based on regression splines, neither is accurate for GFR greater than 90ml/min. The MDRD formula was updated in 2005, and this later revision is used in this package. The CKD-EPI formula was recommended for estimation of GFR in adults in NICE Clinical Guideline 128 (2014). In the USA, the MDRD formula was recommended in NKF-KDOQI 2002, and the CKD-EPI formula recommended by KDIGO 2013. Both produce an estimate of GFR for a patient with body surface area of 1.73m<sup>2</sup>.</p>
<p>The bedside <strong>Schwartz</strong> formula is more accurate in children, and recommended for GFR estimation in patients under 19 by the National Kidney Federation and National Kidney Disease Education Program in the USA.</p>
<p>The <strong>Cockcroft-Gault</strong> equation estimates creatinine clearance rather than GFR and tends to overestimate actual GFR as creatinine is cleared from the kidney by tubular secretion as well as glomerular filtration. It is still widely used for renal drug dosing, although the National Kidney Federation in the USA recommend CKD-EPI or MDRD instead.</p>
<p>Results from eGFR calculators may vary due rounding errors. The functions in the <em>transplantr</em> package convert creatinine units as 1.00 mg/dl being equal to 88.4 µmol/l</p>
</div>
<div id="ckd-epi-formula" class="section level1">
<h1 class="hasAnchor">
<a href="#ckd-epi-formula" class="anchor"></a>CKD-EPI formula</h1>
<p>The CKD-EPI formula eGFR is calculated from age, sex and ethnicity as well as serum creatinine. The basic function to return its value is <code><a href="../reference/ckd_epi.html">ckd_epi()</a></code> which takes creatinine in either µmol/l (by default) or mg/dl, age in years, sex as <code>0</code> for female or <code>1</code> for male, and ethnicity as <code>"black"</code> or <code>"non-black"</code>. The <code>units</code> parameter defines the units used for serum creatinine, taking a value of either <code>"SI"</code> for µmol/l or <code>"US"</code> for mg/dl; if the parameter is not provided, it defaults to <code>"SI"</code>.</p>
<p>There is also a <code><a href="../reference/ckd_epi_US.html">ckd_epi_US()</a></code> wrapper function which uses mg/dl as the creatinine unit. This is quicker to type than <code><a href="../reference/ckd_epi.html">ckd_epi(..., units = "US")</a></code> but is very fractionally slower.</p>
<p>This is a vectorised function, which takes numeric vectors as its input and returns a numeric vector. I would typically call the function from within a <code>mutate()</code> call in a <em>dplyr</em> pipe, which adds a new variable to the dataframe:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1">mydata &lt;-<span class="st"> </span>mydata <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb2-2" data-line-number="2"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">eGFR =</span> <span class="kw"><a href="../reference/ckd_epi.html">ckd_epi</a></span>(<span class="dt">creat =</span> SCr, <span class="dt">age =</span> Age, <span class="dt">sex =</span> Sex, <span class="dt">eth =</span> Ethnicity))</a></code></pre></div>
<p>If creatinine is measured in mg/dl, the variant code would be one of these two alternatives:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1"><span class="co"># using the standard function</span></a>
<a class="sourceLine" id="cb3-2" data-line-number="2">mydata &lt;-<span class="st"> </span>mydata <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb3-3" data-line-number="3"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">eGFR =</span> <span class="kw"><a href="../reference/ckd_epi.html">ckd_epi</a></span>(<span class="dt">creat =</span> SCr, <span class="dt">age =</span> Age, <span class="dt">sex =</span> Sex,</a>
<a class="sourceLine" id="cb3-4" data-line-number="4">        <span class="dt">eth =</span> Ethnicity, <span class="dt">units =</span> <span class="st">"US"</span>))</a>
<a class="sourceLine" id="cb3-5" data-line-number="5"></a>
<a class="sourceLine" id="cb3-6" data-line-number="6"><span class="co"># using the wrapper function</span></a>
<a class="sourceLine" id="cb3-7" data-line-number="7">mydata &lt;-<span class="st"> </span>mydata <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb3-8" data-line-number="8"><span class="st">          </span><span class="kw">mutate</span>(<span class="dt">eGFR =</span> <span class="kw"><a href="../reference/ckd_epi_US.html">ckd_epi_US</a></span>(<span class="dt">creat =</span> SCr, <span class="dt">age =</span> Age, <span class="dt">sex =</span> Sex,</a>
<a class="sourceLine" id="cb3-9" data-line-number="9">          <span class="dt">eth =</span> Ethnicity))</a></code></pre></div>
<p>If you don’t like <em>dplyr</em>, the functions also work well within Base R:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1">mydata<span class="op">$</span>eGFR &lt;-<span class="st"> </span><span class="kw"><a href="../reference/ckd_epi.html">ckd_epi</a></span>(<span class="dt">creat =</span> SCr, <span class="dt">age =</span> Age, <span class="dt">sex =</span> Sex, <span class="dt">eth =</span> Ethnicity)</a></code></pre></div>
<div id="calculating-serial-egfr-results" class="section level2">
<h2 class="hasAnchor">
<a href="#calculating-serial-egfr-results" class="anchor"></a>Calculating serial eGFR Results</h2>
<p>In renal transplant follow-up, it is common to report eGFR at various timepoints, such as 1, 2 and 5 year eGFR. This is facilitated by the <code><a href="../reference/ckd_epi.html">ckd_epi()</a></code> function using the optional <code>offset</code> parameter which adds a year to the baseline age. For example, to calculate 1 and 5 year eGFR, the code would be something like this:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1">mydata &lt;-<span class="st"> </span>mydata <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb5-2" data-line-number="2"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">eGFR_1yr =</span> <span class="kw"><a href="../reference/ckd_epi.html">ckd_epi</a></span>(<span class="dt">creat =</span> SCr, <span class="dt">age =</span> Age, <span class="dt">sex =</span> Sex,</a>
<a class="sourceLine" id="cb5-3" data-line-number="3">                    <span class="dt">eth =</span> Ethnicity, <span class="dt">offset =</span> <span class="dv">1</span>),</a>
<a class="sourceLine" id="cb5-4" data-line-number="4">         <span class="dt">eGFR_5yr =</span> <span class="kw"><a href="../reference/ckd_epi.html">ckd_epi</a></span>(<span class="dt">creat =</span> SCr, <span class="dt">age =</span> Age, <span class="dt">sex =</span> Sex,</a>
<a class="sourceLine" id="cb5-5" data-line-number="5">                    <span class="dt">eth =</span> Ethnicity, <span class="dt">offset =</span> <span class="dv">5</span>))</a></code></pre></div>
</div>
</div>
<div id="abbreviated-mdrd-formula" class="section level1">
<h1 class="hasAnchor">
<a href="#abbreviated-mdrd-formula" class="anchor"></a>Abbreviated MDRD formula</h1>
<p>Using abbreviated MDRD formula eGFR is also calculated from age, sex and ethnicity as well as serum creatinine. The basic function to return its value is <code><a href="../reference/mdrd.html">mdrd()</a></code> which takes creatinine in either µmol/l (by default) or mg/dl, age in years, sex as <code>0</code> for female or <code>1</code> for male, and ethnicity as <code>"black"</code> or <code>"non-black"</code>. The <code>units</code> parameter defines the units used for serum creatinine, taking a value of either <code>"SI"</code> for µmol/l or <code>"US"</code> for mg/dl; if the parameter is not provided, it defaults to <code>"SI"</code>.</p>
<p>Like CKD-EPI function, there is also a <code><a href="../reference/mdrd_US.html">mdrd_US()</a></code> wrapper function which uses mg/dl as the creatinine unit.</p>
<p>This is also vectorised function, and is generally called from within a <code>mutate()</code> call in a <em>dplyr</em> pipe:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1">mydata &lt;-<span class="st"> </span>mydata <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb6-2" data-line-number="2"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">eGFR =</span> <span class="kw"><a href="../reference/mdrd.html">mdrd</a></span>(<span class="dt">creat =</span> SCr, <span class="dt">age =</span> Age, <span class="dt">sex =</span> Sex, <span class="dt">eth =</span> Ethnicity))</a></code></pre></div>
<p>Using mg/dl as units or base R work in the same way as the <code><a href="../reference/ckd_epi.html">ckd_epi()</a></code> formula, and the <code><a href="../reference/mdrd.html">mdrd()</a></code> can also accept an optional <code>offset</code> parameter to facilitate serial results.</p>
<p>There is also a fuller six-variable MDRD formula which may be added to this package in the future. The six-variable formula includes albumin and either urea or blood urea nitrogen (BUN).</p>
</div>
<div id="schwartz-formula" class="section level1">
<h1 class="hasAnchor">
<a href="#schwartz-formula" class="anchor"></a>Schwartz formula</h1>
<p>The bedside Schwartz formula is used for children under 19 and is a simpler version of the original Schwartz formula published in 1984. It is calculated using the <code><a href="../reference/schwartz.html">schwartz()</a></code> function and uses serum creatinine in either µmol/l (by default) or mg/dl and height in cm. Like the other formulae in the package, the <code>units</code> parameter defines the units used for serum creatinine, taking a value of either <code>"SI"</code> for µmol/l or <code>"US"</code> for mg/dl; if the parameter is not provided, it defaults to <code>"SI"</code>. There is also a <code><a href="../reference/schwartz_US.html">schwartz_US()</a></code> wrapper function which uses mg/dl.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1">paediatric_data &lt;-<span class="st"> </span>paediatric_data <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb7-2" data-line-number="2"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">eGFR =</span> <span class="kw"><a href="../reference/schwartz.html">schwartz</a></span>(<span class="dt">creat =</span> SCr, <span class="dt">height =</span> Height))</a></code></pre></div>
<p>In the same way as the CKD-EPI and MDRD functions, using the optional offset parameter helps to generate serial results.</p>
</div>
<div id="cockcroft-gault-formula" class="section level1">
<h1 class="hasAnchor">
<a href="#cockcroft-gault-formula" class="anchor"></a>Cockcroft-Gault formula</h1>
<p>The Cockcroft-Gault formula provides a reasonably accurate estimation of creatinine clearance, but this is <em>not</em> the same as glomerular filtration as creatinine is also cleared by tubular secretion, and so the equation tends to overestimate GFR by up to 25%. It is still used in renal dose calculations in the UK, although the US guidance is to use CKD-EPI or MDRD instead. It is also worth noting that the methodology from which it was derived assumes ideal body weight.</p>
<p>In the <em>transplantr</em> package, the creatinine clearance can be calculated with the <code><a href="../reference/cockcroft.html">cockcroft()</a></code> function, which takes creatinine, age, sex and weight as core arguments. The creatinine is in µmol/l by default, but can be changed to mg/dl either by specifying <code>units</code> to be <code>"US"</code> or by calling the wrapper function <code><a href="../reference/cockcroft_US.html">cockcroft_US()</a></code>. Ideal body weight can be calculated from height and sex using the <code><a href="../reference/ibw.html">ibw()</a></code> function. An example using a <em>dplyr</em> pipe:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1">mydata &lt;-<span class="st"> </span>mydata <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb8-2" data-line-number="2"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">Ideal.Weight =</span> <span class="kw"><a href="../reference/ibw.html">ibw</a></span>(<span class="dt">height =</span> Patient.Height, <span class="dt">sex =</span> Patient.Sex),</a>
<a class="sourceLine" id="cb8-3" data-line-number="3">         <span class="dt">CrClear =</span> <span class="kw"><a href="../reference/cockcroft.html">cockcroft</a></span>(<span class="dt">creat =</span> Patient.SCr, <span class="dt">age =</span> Patient.Age, <span class="dt">sex =</span> Patient.Sex,</a>
<a class="sourceLine" id="cb8-4" data-line-number="4">                             <span class="dt">weight =</span> Ideal.Weight))</a></code></pre></div>
</div>
<div id="formulae-to-be-added-in-future" class="section level1">
<h1 class="hasAnchor">
<a href="#formulae-to-be-added-in-future" class="anchor"></a>Formulae to be added in future</h1>
<p>The <strong>Nankivell</strong> and <strong>Walser</strong> formulae are less commonly used. The Nankivell formula is the only eGFR formula derived entirely from renal transplant patients, but included patients with unstable GFR. The Nankivell formula includes weight and height so approximates an absolute GFR. The Walser formula produces a result standardised to a height-squared of 3m<sup>2</sup>.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#introduction">Introduction</a></li>
      <li>
<a href="#ckd-epi-formula">CKD-EPI formula</a><ul class="nav nav-pills nav-stacked">
<li><a href="#calculating-serial-egfr-results">Calculating serial eGFR Results</a></li>
      </ul>
</li>
      <li><a href="#abbreviated-mdrd-formula">Abbreviated MDRD formula</a></li>
      <li><a href="#schwartz-formula">Schwartz formula</a></li>
      <li><a href="#cockcroft-gault-formula">Cockcroft-Gault formula</a></li>
      <li><a href="#formulae-to-be-added-in-future">Formulae to be added in future</a></li>
      </ul>
</div>
      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by John Asher.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
